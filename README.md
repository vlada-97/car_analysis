
█▀▀ ▄▀█ █▀█   ▄▀█ █▄░█ ▄▀█ █░░ █ █▀ █▄█ █▀
█▄▄ █▀█ █▀▄   █▀█ █░▀█ █▀█ █▄▄ █ ▄█ ░█░ ▄█

## Описание
Данный проект анализирует данные об автомобилях, такие как пробег, стоимость, производитель и другие характеристики. Основная цель — выявить полезные статистические данные, такие как:

Топ автомобилей с минимальным и максимальным пробегом;
Количество автомобилей определённых марок среди самых дорогих;
Статистика пропущенных данных и обработка выбросов.
Проект использует такие библиотеки, как pandas для работы с данными, matplotlib для визуализации и structlog для логирования.

## Установка
Клонируйте репозиторий:

```bash
git clone https://github.com/vlada-97/car_analysis.git
```

Установите необходимые зависимости:
```bash
pip install poetry 
poetry install 
```

*_Примечание_*
Рекомендуется использовать _Jupyter notebook_ для упрощенной работы с датасетами. 
Его можно добавить, убрав комментарий -> # notebook = "^7.2.2" в 'pyproject.toml', или 
```commandline
poetry add notebook
```

## Использование
Подготовьте данные в формате CSV, содержащие информацию об автомобилях (например, столбцы: manufacturer, model, odometer, price, year и т.д.).
Или воспользуйтесь готовым csv [по ссылке](https://dazzling-caption-fe8.notion.site/csv-ca695565045241148e91024d9489d6fe?pvs=4)

Запустите основной файл для анализа данных:

```bash 
python main.py
```

Скрипты поделены по функционаду для удобства. 
- main.py - основной скрипт и парсинг .csv
- general_functions.py - функции по обработке данных
- diagrams.py - построение диаграм 
- analytics.py - аналитика и сводные таблицы 


Используйте предоставленные функции для обработки данных и получения необходимых статистик.

## general_functions.py
### Эти функции помогают обрабатывать и очищать данные, удаляя выбросы и пропуски, что важно для дальнейшего анализа данных.

### 1. `get_missing_values_sum(df)`
Эта функция вычисляет количество пропущенных (NaN) значений в наборе данных (DataFrame). Она суммирует все пропуски по каждому столбцу и выводит общее количество пропущенных значений.
- **Параметры:**
df: DataFrame с данными.
- **Возвращает**:
Суммарное количество пропущенных значений во всех столбцах.

### 2. `get_columns_with_missing_values(df)`
Функция возвращает список столбцов, которые содержат пропущенные значения.
- **Параметры:**
df: DataFrame с данными.
- **Возвращает**:
Список столбцов, где есть пропущенные значения.

### 3. `drop_extreme_values(df, col, lower_quantile=0.005, upper_quantile=0.995)`
Функция удаляет строки, где значения в указанном столбце являются экстремальными (слишком большими или слишком маленькими). Экстремальные значения определяются по квантилям.
- **Параметры:**
df: DataFrame с данными.
col: Столбец, в котором нужно удалить экстремальные значения.
lower_quantile: Нижняя граница для удаления экстремальных значений (по умолчанию 0.005).
upper_quantile: Верхняя граница для удаления экстремальных значений (по умолчанию 0.995).
- **Возвращает**:
DataFrame без строк с экстремальными значениями в указанном столбце.

### 4. `handle_missing_values(df)`
Функция обрабатывает пропущенные значения в наборе данных. Для строковых данных (тип object) пропуски заменяются на наиболее часто встречающееся значение (мода). Для числовых данных пропуски заменяются медианой.
- **Параметры:**
df: DataFrame с данными.

### 5. `drop_columns_with_missing_values(df)`
Функция удаляет все столбцы, которые содержат пропущенные значения, а затем удаляет любые оставшиеся строки с пропущенными данными.
- **Параметры:**
df: DataFrame с данными.
- **Возвращает**
DataFrame без столбцов с пропущенными значениями.

## diagrams.py
### Эти функции помогают визуализировать данные, строя диаграммы для анализа распределения типов топлива и зависимости цены автомобилей от года их выпуска.

### 1. `get_fuel_type_diagram(df)`
Эта функция создает круговую диаграмму, показывающую распределение типов топлива в наборе данных.
- **Параметры:**
df: DataFrame с данными.
Описание:
Функция сначала проверяет, присутствует ли в наборе данных столбец "fuel" (тип топлива). Если столбца нет, она выводит ошибку. Затем функция подсчитывает количество автомобилей для каждого типа топлива с помощью value_counts(). На основе этих данных строится круговая диаграмма, отображающая доли каждого типа топлива.

### 2. `create_diagram_dependence_price_of_year(df)`
Эта функция создает диаграмму рассеяния, показывающую зависимость цены автомобиля от года выпуска.
- **Параметры:**
df: DataFrame с данными.
- **Описание:**  
Функция удаляет экстремальные значения в столбцах "price" (цена) и "year" (год выпуска) с помощью функции drop_extreme_values(). Если в наборе данных нет нужных столбцов, она выводит ошибку. После этого строится диаграмма рассеяния, где по оси X отложены цены, а по оси Y — года выпуска автомобилей.

## analytics.py
### Эти функции помогают сравнивать цены на автомобили, анализировать их пробег и определять количество автомобилей определенной марки в топе самых дорогих машин.

### 1. `compare_car_types(df, car_type_1="bmw", car_type_2="mercedes-benz")`
Эта функция сравнивает средние цены двух типов автомобилей — по умолчанию BMW и Mercedes-Benz.
- **Параметры:**
  - `df`: DataFrame с данными.
  - `car_type_1`: Первая марка автомобиля для сравнения (по умолчанию "bmw").
  - `car_type_2`: Вторая марка автомобиля для сравнения (по умолчанию "mercedes-benz").
  
- **Описание:**  
  Функция проверяет наличие столбцов "manufacturer" и "year". Затем фильтрует автомобили указанных производителей, выпущенные после 2018 года. Далее, она группирует данные по производителю и вычисляет среднюю цену для каждой марки. Результат сравнения выводится в лог.


### 2. `get_odometers_min_max(df)`
Эта функция находит автомобили с минимальным и максимальным пробегом среди автомобилей, выпущенных после 2020 года.

- **Параметры:**
  - `df`: DataFrame с данными.
  
- **Описание:**  
  Функция выбирает автомобили, выпущенные после 2020 года, и удаляет выбросы в столбце "odometer" (пробег). После этого удаляются дубликаты по производителям. Далее функция находит три автомобиля с минимальным пробегом (исключая 0) и три автомобиля с максимальным пробегом, а затем выводит их в лог.


### 3. `get_top_100_expensive_cars_count(df, car_make="mercedes-benz")`
Эта функция подсчитывает, сколько автомобилей указанной марки входит в топ-100 самых дорогих автомобилей.

- **Параметры:**
  - `df`: DataFrame с данными.
  - `car_make`: Марка автомобиля для подсчета (по умолчанию "mercedes-benz").
  
- **Описание:**  
  Функция удаляет дубликаты автомобилей, сортирует их по цене в порядке убывания и выбирает топ-100 самых дорогих. Затем она подсчитывает количество автомобилей указанной марки среди этих 100 и выводит результат в лог.
